import streamlit as st
import numpy as np
from PIL import Image
from tensorflow.keras.models import load_model
from tensorflow.keras.preprocessing import image
import requests
import os

def download_model(url, output_path):
    if not os.path.exists(output_path):
        with st.spinner('Downloading model... Please wait...'):
            r = requests.get(url, stream=True)
            if r.status_code == 200:
                with open(output_path, 'wb') as f:
                    for chunk in r.iter_content(chunk_size=8192):
                        f.write(chunk)
                st.success('Model downloaded successfully!')
            else:
                st.error(f'Failed to download the model file. Status code: {r.status_code}. Check the URL or network.')
                return False
    return True

model_path = 'potatoes.h5'
model_url = 'https://drive.google.com/uc?export=download&id=1OvyHsGPReRkt-krG207BvgXynjiXGR9Y'

if download_model(model_url, model_path):
    try:
        model = load_model(model_path)
        st.write("Model loaded successfully.")
    except Exception as e:
        st.error(f"Failed to load model: {e}")
        st.stop()

def preprocess_image(image_file):
    img = Image.open(image_file).convert('RGB')
    img = img.resize((224, 224))
    img_array = image.img_to_array(img)
    img_array = np.expand_dims(img_array, axis=0)
    return img_array

def predict_disease(image_file):
    processed_image = preprocess_image(image_file)
    prediction = model.predict(processed_image)
    return prediction

def main():
    st.title("Potato Diseases Classification")
    
    background_image_base64 = """
/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxITEhUTExMWFRUXFRcVGBYYFRgXFhcYGBYYFxUbFRUYHSggGCAlHRgXIjEiJSkrLi4uFx8zODMtNygtLisBCgoKDg0OGhAQGysmICUtLS0tLS8vMC0vNy01Ly0vLS0tMS0rLy0tLS0rLS8tLS0vLTAvLS0tLS0vLS0tMC8vL//AABEIALcBEwMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAAFAAIDBAYBB//EAEEQAAIBAwIFAgMGBAQEBQUAAAECEQMSIQAxBAUTIkFRYQYycSNCUoGRoRSxwfAVYtHhFjOSokNTctLxJIKTwuL/xAAaAQADAQEBAQAAAAAAAAAAAAABAgMABAUG/8QAMhEAAgECAwUHAwUBAQEAAAAAAAECAxESITEEE0FR8BQiUmGBkdFxobEVMsHh8UIjBf/aAAwDAQACEQMRAD8AHnl1Rd0I/LU1F2GJOtJwvHjzj+WrwoUqnzIp9xg/qNet2m2Uonz3Yr505GWWodWuH4kjfbRup8Oqf+W8ezCf+4f6aqVeS1U3WR6jI1RVaUyboV4Z2FS4qdGOA4lTrPdEjU9EkaWpRUlkUpbRKLzNLX5dSfdFPvGdCuYfC4i6kfHynM/nqXhuPjc6v0OaJsdc63tN5M7XuKq7yRjOJ4B0MMpH5ag6WtjxfE0ypDQw/l9NZ96A8a7adVyWaPNrbPGD7ruDTS11KOrhpa509VxEcA0cNKnb9dKgsAAbzkakWR505Inu28xvqbuWjYgtYkW7nEaiqo090/n6aLUaIHepBgA+4nGdd4u0gSBO+AIg+ukx5ld3le4GCaeE1YNPXRT0zYqREE1IqakVNSrT1NstFDETU6JpyU9T06epSZeKGKmpkTU68PjT0p6g2dEYkaJqdaenpT1MlPUpMvFDFp6lWnqRE1MqalItEiWnqRU1KE1IF1GSKojWnqRU1IF08LqMkVTIwmnWalC67brnlEsmQ2a5qe3XdTwmxnmy8P6iPy1ap0CBIxojw5ncA/oD+uiVBEjA/I6+ilW5o+chs/Jgzh6rjV2hxTen9NWl4Yeg/rpWxuAR9P8ATSXi+BdRlHVnCtOoIqIPr5/UaG8bye3KG4fuNFqYX6ag4pjp6cpRdkLWhCUbyXqADR1zp6IOk6Z0tdimeduymE0xqXpq90tIJrYjYAc1LTTS0ZXhEOzftpPyw+GB/bQ3qG7PLgBOlpdLV96BBjTenpsYmApCnqQU9WumNT0aM+39+dK5lIwB54c+h/TTenrXcPwyhCwgiO6DJx6aF8Xw9xLACDttMeJj+uoxrXZ0S2fCrgdaepVp6tdDTlpadyFUCFKepkp6lWlqVKepSZaMRiLqZE09KepkTUWy8UNSnqVaepFTUypqTZZIiWnqVU1Kqam/hz7fqNTbKIrhdPVdSBNOCaRjoYF08LpwXTgNI0OmNC67GngaUajJFLjLdLT40tJhNcyXDsvlT/PVtEpH/wAQqff/AH0loe2pRS17LS4M8SMnxRLw6Dbqgj3j/XUlagf8p9wf56r/AMMPQa7/AA40uGz1K47q1iGpw5BzpNwzRMSPXf8AlqZaEeTqytQxEA/tp8UkIoQeoKNPXOnom6r4GoTS06mTdOxUpgjbT6rBt1/PU5paaaWjdams0rFFqXppyMR7/XVyz2GmGl7aOK4MFtCu5uEQP01XajGr5padTEa2K2hsGLUGdLXRT0SqUgfT+v5a4/Ckb628Rt0+BRUH1OpEdhsSNTdLXRT0G0MotEEE76eE1b4bh7jEgH31cq8IVzbj66k6ivYtGm7XBgTUipq2xnTQmlxD4SNV1Kq6eqamFPSNlEiNV1Ki6lRV99dtGptlEhKI12NdC6eBpRjoYnGuRqRE1KKQ0AkFuuxqUprlulaCmMjSjTiNLSNDpjdLXdLS2DczP8MRt+zn+o1MrsMG4/kD/TUacABuf6f66tLwf+dx+eu26POSlwHI4PmPyGp6aT5B/v66iHBH8bfnn+uujh2Bw/7aW/JlEuaJmo++ozHrpdKp+Mf3+WkaNT8a/vplJgcVyHpRnbSfhyNxplMVB4U/QjUvUc/d/lrYmHBEi6WmmlqyrtvadOet7No42DdopGnrhpatdRdcuXRxg3ZUNLXOnq+FHqP11zpj21t4DdlEUh/Y0+z3/bVo0xpdLWxXCo2KhX6aZ0tXujrvR0MYcBRWlmcj6aucNxLrg5Hvj99OFL+8afb/AHtpJZlIqw9wlQTs3r66rPRg7zqwKWNIU9KnYZq5XCaeF1ZFMRpBNHEaxCF08LqQJpwXSthGAacBp8a5J9B+ugwiA1MmoAW8Aad3+2luEkY65GnppFdExHrhGpI1yNK0G5HGlp8aWhYIFHDD3H56evD+50OHOW/8v/u/21IOcH8A/X/bUP1LZ/F9n8EtxLkEOj7n9ddFI+GP66ojnB/BqLiua1Cv2YVWndgWEecAj+es/wD6Oz2/d9n8DbifIJGifxa5/Dn1/b/fVYc3/wAn767/AIwPwH9Ro/qOz+L7P4NuJciwOF9/2H+unjhv8x1Qqc3ae1Fj3Yz+wxpq82qeUSPMM37Y0P1Kh4vs/gO4lyCRoe513o6pVOcfhTPucfsNcTm5gymfENIn3kfTW/UKHi+z+DbifIvBWAgMf003pN+I/wB/nqm3ODiE+stHptg++nDm48oZ9mx+4Gt+oUPF9n8B3M+RaFJvxfr/APOu9L1j9BqoecL+D9WGmtzxR90D/wC8T+kaPb6Hi/PwDdS5BAJ7D9NLp+w0NPxDTHj/ALp/kNcPxEn4f3//AJ1u3UPEDAwl0fb+endL6/roUfiNPwn9f9tL/iNPwH9f9tbttHxI2ELwfb9dOE/3/wDGg4+Jaf4T+o/mdRVfiymBNhgCSZwBaWJOPQE/SPUaK2yk9JBwh+NdC6zy/FakxYfIjcyDacYnJj66d/xSnhT+kf8A7Z1u1UvEjWNDroXWfHxOv4f2j+baePiZfwH9/b6+ut2uj4kGweC6dGgK/E6fgb64/wBdPPxLSG4I+s/0Gt2qj417msw5GuxoMvxHR9/+l/8A266PiWhMXD9/5Ro9po+Je6NhfIMxruhS89on738/9NO/xyj+L9j/AKaPaaPiXujYJcgnpaFjntD8R/6G/wBNO/xqj+I/9D/+3W7TS8S90bBLkEdcOh/+NUfxH/8AHU/9ul/jFH8f/a4/poPaaXiXug4Jci/paHf4xQ/81f3/ANNd0O0U/EvdBwS5GcRNOCj1/s6AUeZO4DGoiTJtKzI9PmEnA/lqanXqsLY7vMDBCgSoM72mSQTER9fnW0jqdeIbgeo/aP21zt9fT1+g20AHHKVUmoIaxckAgsSCSVOTMefB8jTKD3hh2nuVQJJuIEHBORnzEgHadG/kB7RyRoOqo87H19/XTH4ymJkgRncfvoBxVMKGtFRlII+80GA7GQewRjaBt6ab/DksrAm0sZS9iYYZBDIbgBkjtiNz5ZNaiPaJcg6eY08ZBG05I2O5Axsf0PkRqP8AxITAVtiSbcCDsTkA/WNDatRiD2GBmZ2kSysZBcwAIAHuZkar3lEBcAJmSqukGZa1ic4IysAfmRrK7A60wvU5iQJiDnE5xM4APpqOvxtQEAwpJju7R8sjP9SIx40OpBHW5WYA27NdJ9S5MiCAZuG0nxqUUSGuk24MwWzmJFxOR4J3UiMkawjqzfEs0+LZlm72+7Ej5s5jfYkbH01FUZvUsonYkEwomYOP9zqhVAuIZqiD0NMAiSQQtS21jiR5iYk7Pp8RUCkgBz23tNl3YRNpFzR9BFvgCNHAxXOXFlgmcgiCZLAiANjt5xMx+WpWEyDIO4wDgR4yJEgb+IxodVrQ8tTcCR9oSqgrlgVDNtnMMDkYg6i4rmlIU2NI++an2fyzv824O21viMHdN2sJiCTVCD3ZnxJuIwTAjv8A2ONdqcQskscyMKIaTMyoErv/AHvqnwxKLLkgQCHaTTkgQpI2mZ722MfV/DcWoaab3AkgMzqFEGIS0gkgAb+G8wZDpo2Iko5EqQy5Jc/IM7KwHd82QDiR7Sk4hYLXFgTAgDLAbJTUgtswk/vEaqipUJwwqNblyHWkougOJwcGSTExvuS+sacsbVqVW7icG2FzcG+QACJMCMzMgvgQMRcMm0DLxlfmRJElqpAPpsMSBvqhx1QNS4llIYU6LpJ3apUX7QkA+BbmBvEQI0xn/hKIcxWZ8KSO/eVzsIBUxPkEmSNVeYcJ0+BqXFbmEu1wYqTbcbj93MxmQN/SkIK6+qX3zNcIuCzKR2dUIyE4tqoADM7q62qRv7a7wXEdS49wZSQ9M5Ijftx1F9IIYADJGqnFKK/BK9Noan9qMj7q+cwcQf5ZE6ZxtR+mnF0yxcABwIJZBOTaAcT6ntG430HBPL06+prhKlUELkAthZYFHwJg4K7ntMRHny7rFZLDYZgwQJ3YHYH8Rt3x7M4XjOqkpZMZRlimxHnF2ZGCJn9DpcPWFpslwDDUywvXJkpMMwjwPXztqWDmhlIt0qwO5U4kfLcR+Zg/UE4MkjTg2cAjEkD1AkwFz6+P9DSVUcsVe03dykKh2hup8wYyMyBnc7T11qLkoDbMQsEEDMK0qTgZU7DSbtPQpcv01ByMzn5W+mY/vfT4YCRkeIJ8ex8/tt6jQtK6fPaGyB2qVe4kBpWSc+ogAHA8asJXXPTIY3AFSomfTeT9bvy8hJUrMKZYY5ykiJ8En8vT6HxrocA5wM/dCkbRMf3t7aiTijk2x4hW2IEZV7Sc5iTP54lp1C0rgARJ3n0lcEGAcfz2COlYZMeSk5PsRewt8wROP9jqS0HZvpBVp39j6D9dRO4J+Um27OYjfDBYGxEex3jUQsNxOCBFrAAwfFzflEH8hpMLfMbEWCSPJ/O3+cCNIMSJDCPZSf3FT6/vqNaYntfcGBOM/mVMSPPnx4dVVxjBMLKswuI39/cxvjWwt6MbEzoLHzPuA5H6zruq1Th3JkgjbYH0+ulobufmHGUH4omIptfVkx3IokAMzUy8vMQQMgCd9ScSLYd3Vf8AlhsEowUdxeu/yqYGDkwoGdQ8Xw6uCbHFR1UdQ3RUtBtBagvecTkQIEkjGpm4aoKciqyLEMVpqDcxIXqJBKgD7x9ckeelR0z668jmasc4qsGtPSLMREdJi7G4LeGBC/hPqIG+AX0KfchpAECVMAElGAu7mk9sntj72c7BpcrYGNJZW7qEf8wg5sBuGxhsyBAHjU3CcNxKO3UF9EGRIQGo3ZBsYEESZiQcr5xqm7STV+uvMXF5BHgqbFwrMzgR3WWhbXBEkMxZgAxiBMmCCdLiGrspFqgyGZ5aTBMEqFtNwG4MCDPjVFeaVA3SqhSsQSrp1KQAvk3YInGxgAbbEpTquzPTLo9R6cFTUKhCV2TEzHliPON9LZp3suvoa5Tr8VSCmK2WRzTKwVqW/KKbEBG2mMyfA3LuW1ancrTJVTcUe0zBJWookdtpEXDIGTOuc3S1GrX9A32SEFWCQwJVXtk9rAldwSQTnQdOdrSYKGWo0dJKxUrcG2AP/qPpI9TnVowco93r7E27BWoKrSKdYBQVViS/Vk9pueCEYAnGfQmdn8FQTqBVYB2DKzsykMwqd1ylFIbBOB90HMmBycabweIBAKrcGpGpRSZhQchJKnMBpGdTrzGm5YFVFir8wYU7LY+QISFJlpiMkyJjRcHoDEEKnEuu+blLQCUxiQ8i3tJwcwLoAjVHi2CsHV6duR2p3oSTcYLCDkHJgwZyANLiLaYqDq1RgWCnVDXiBimoAZ1WMggYggGQDa4Tm1ymoKdZQQaSsyWkHOGFIXAC0hSVBB1o5ZpXC2QI6Oga8FYBNQqKkm2GYNMITORjxnciJ+NS80qXTrVCzC7FwMXJcyiIAnuGAUHy6byvlzFDWqVGV1ItItZIJuk2qCVYEgsQDJjIAmjzHjxw9ToC4H5aZiVRcR0kumANgLhEwCDGqxjeTje4jfE63GEuvUPfLGnT7VKz29wOD90gEycesavcLwlSo9zYAWbAy2MstYu/YxEmMZ9NBOVw6kVqdaoplSzUWCIAuzZtdhEQf28kON40MLqKKrGld29zCkPmL04BE3AS3yhTEwdPKNnhQn1LVTmYDmgoFyqQelcxClhllCwuBMk4zvOLl/RyKLSxIuApN3qDItUyPcXA5MDQH4fZg3UrcOAFYgPVYoGVwWKhSpMhVvnc2NB2GrvN+PVqDUWqgFkJFzLZUNoHfVXFygXGfA+h0jp95RXqOmV+zja4Y3i0HCU7iSLwe/EsCslWk7HbV/4yrseGKUmYVAyraSFIULi0NGSTaLACT+mhnw5y3iadMHqEEq1Ng1MtTKAm0I6TfgjzIuMSJhnxdxBajZVrU+pKOSCSmAoSXxaSIYQNjIA3NMKdVJPQN7Gh5H1anDgVBTIi0oKgDqwDA3AjcXN9Nu7Qb4f4s06r8MxYID04IVFBYSizZ3AgxLKJGPTUXw/z5KS06YqklrRHUGQM5WosYBXAEfSDrnPeanqIQr9Ri4cAHqlVAAhSSdoBJwREYjSqDxyhbUKeR3mfGfwXEwn2asICFLQDJHa5IFoCzIGSx0S4uj/FBa9J0DZJBNNxVnGUuBDYC5PqfJGrfL+Mp8TTenJUwAQdzBBLBIhCZGIgkzgjWWp8eaVR0NyktLhunU6lxBwVww942ziDCqLk7pd5BvkaGgiVGC16JpOwAv7jMkqsx2kbx4BXznUvEcaaCBa6p0zIUiEDFZ+6pGbWnYnI3GpuB4tKqimXvPduyG3aGSp8xNseQcmZBA0N4rllSkPt1FZIBusLd5J7iJUpvGMi72jUVFt972+BkwpwwVgbSWGQUcTYDA7XlSpAgfT6aXHfZkEqXtk9Nyh7RFxpu1uAGBMR5MHQyhRNQhqIQodkggllO07HEbEb+Yz2nzzuC1ATgMUqAEiQBJRyI3AkeI86GF35jKRNX5jSZVF+BupzaDBAAD3KpI3Wf9O0nCzCEqAflqAgDdt2IgjIYiRjOCB2nyag4EI9NiwzSVkBDbgXFgpn0j9NTKqUhN7EezNd4uL0QBcR+IbSMaN4aRTHT5EvCmkyGCrnIB7kMZksT2z7/rOJfxT/AHKhdR8qszE+vkMQR52iJHpA3jUVQtarWCwWCMGC3gqLMMBkgDDeCd41Nw/FEuStY5xAAZDaQTJEZON/y20mFtuQUWqddVUXiQSYcQJIBjNSQP6zOu3xcC8OCLZQQMg/MCYO+IH01WbjKfzNTQEMFK2sUDbCTkJj6b7kaclRaoRb7ZJw1tRVABkIxErMTafQGRpHFLJ+/X+DJk1PiKwECCP8uV/IjS0K5jRqdRu/zuAxB9TJBOd9zvpaD2TFnYbEgvzHhXLpFVhcGlVSm7HfeoQQBkm0yYugnbVLmD1UsalQNQq7LUZw0MkCGXcekQABGInUdPiqfQv6zKVYpca5YmGF8opyIiFCzhjuY1a5bxrHh2VFJJBZTUvAKsVADIWJ+60ZtM5gaCWH0dtLfc5ilwrHiLkoo9JSA9TtnOzAMVwo9iDk+BqlU452rGg1Zj01lWpuBMKWInIMSe5iPpM6u1uF5jVGatPptuB2mBB7zCh9xkN4AnxrlClQRS1UXg4QVKFySoJK3qwVfYTOMg66U4rW30Wb9X1kKzvA8wZ6ZpUWpkLIJqmLpzFrXYa2TBC+05088OawpmqyJb2qxdm8ZaTMEgXydp876hbgeHeKtOiHQIWBtNNogMt7ArI2GxOT8wyWj4e+87CjgtClWQKRjuM3RmVIXYCSZOheFr6Prz/gzvwLnNOIUFXsUgtIYqz1Rk/NUs7RLJCn5QNvAscRUbpHiKqPSLNKsKaVOmTTF2HE9zbhgdt/Os5S5kUDdOpSsJDuq00FwHyNUKiFkAGUM5XO51Z47mvE1G6nDwCR3OxCmyN1uFu2PlBIPjycDuo8OuuImIJU6XDNSIrKG6gEAASBPd01U3ASjLCrgrkRnQ8cxqCovD0ksSmzIDWYOxk3iFUm0WyAp3V50Mo8oqMygcUoCEdqpcUp9QsfKhO5rgsxBO2x1PBcPT4YsapXokZYhySViBc7RmTCj8UyYku8Mcm7+QFdlMcC6NUaoS1FqYNNWDKqEsRYau4BEjYbSPXTKvEGxgjMQ4a0l0CsVK9QLFohSD3WgjAkDOq/NqtRg1VgaasqlLL2dlyAqoXsG6QFX6kyNBuX8PWHFU7kaZC21b6fUf7ocKAVIF024J9Z08IYldgs+AUo8wqvUpgsQlIEMiMhKiB/4ebgMECRuQCoGjPE8KLhxMUXa0Dqu/YysckkJAKi4ByoBAA99R8VTNQVaVKmKUMC1zCbVa61HAIksFgkhSDkYOs1VuordRFU0WekxVgWKBXKfayANwcxgW/mbJ6Zdfya9sgxx/N5oiQhJOTcKgZQAtmCbTEMGz9RjQHk9INV6r1FhGaogZQApCWuJkwhkSBvjHpznQ4qu6E0Q9JwioUK0nvChQ6ipHzSoJ7gIJPpo+606lP/AOpWmayrYmYam0AAVhIBUyYY3AEkiPNV3IZavkLfIbzPnXDk1Cy3oQp+ytaiQMq4jYSFwxP5QDoHQ4uhxfEJSYLRpuGVrVKCow71EqWg4JAEbAemn855pVo1ERSttZQop00ZQe8gGcBmuIk52OSTmxwNN0ChKqWlw1UCi1ZAQVKm0DuAmCSAwjbzpoxUI39jYjScKj0VjptVpKkTSm2ohCh1emNiASQ3m0eT25j4q5lKAJ2RVU2uAItEFBsCpgSp98mY1ruH4RKKvQaoWeosKYPTJbFIFAQEN9hjB7TnI1iviWjW6Zdr+IK1EmpcBH3WBUnuBNgDgASPG2pbOljuyi5Gg5RVvQ10oU0kKGQIxlwGJsS0AljklWxZOPLPi/h6ldKdiKjKUYAuCGBkhHCiHEhoJtPjyNUaHM1bp9FuoUi5C4tJAhRJICEFiOwibjkydEuZcwpH7Jr0RgwPD1LyTPcovPcoYPIqAncjtAknDJTuhVIz3w7zFwpvq98khiRLDcqDIEQdjgz+ukrcW1QAtwnUIUqVKdoJUADtBHTIAO2G2AkDWJq0a1By9NunTDmxn74EygZQWF9p9xg5jJ1/IuKZaaMWWo8AxcUct2yRHyBlOdvJxptpWHvIZa5AnhUPCBA6MQp6d1/ykFT5Ig/KZj0/M5wHOMEdz9trqFiScG4AwRBBkGZVtsHS+IaNN0avVokIlhvUfaAics05HeCA0gZAgxrHcl5rUpMVVJWoQxB9AQ7d0Eg4MRgE7aTA6kcSRrcTZ1yFpVKlOoKbC02wqIQHtlkSRjdW3mJ0uGqU+IYh6akOCRUCrMgSWptkzBMzv+eu0OM6xValMRUUIagNNRcIamCTFpBPk7z5MaEcw4SrSfq0B9mitfeahBYM0dM1FMSI7XJXI9dRir69dMbUm4ms1K6E7ASQ/VmB2wXUgBd2ORGB5B0Yoc2UmGKVFAVbSBdTYZDAhQoIJIMZk+cjQZOd1npzeArKJFvbA3jwT5E48bY0epVaFYJTqBKTgAEYBJKi0CYJBBJA998HSyja2WYydyfhgCSVVqbESU6qsGEgAgOwBjJyfuHONDeZvTV7KtJVDCVYLaSAIlWghwSRgyw2k76q80rrw7FGpVhAClrWNNu4rdeikEEwAJB7smdWeDr9RIeVQlLeoi1Bcw7IuBObSMRvEYEIouP7vfrP0HTGcXTqoqmnU6yHuALhWUj2GTJLSsEQDPoKXHcTZaKgNN4uHbhgVOJmD3He4kBB9DLzGt0KbrUpVVjtFSmrdK1iAVPUwk3JuNScBzRuj8wdN1uQASAQQ9ocjBgYEyfrqjTirpXXXoMi9w/O6RUSah9w6KP+mTH00tZ80w2etQyBgUHgY238aWmy4N/cFuukFuE5rT4ZaiJSFQIDlVlSxuLC6LnYwYn/AOaj06vGKosZanUFsSkqhuRKrvJci4HaMNAA0fRCXFF1EqFFqhQt0FvmVSY7iYHTm3zBixwFVynSpqilXCBySQGJlWVFO5E4L47RtgcrqJd5LPW/XmSz0uDuYcppApwpeqhXvPeKlMKwiO6DJiRK+vrqnz6gaCUxRVXYtd3I1RoQEFhTWoYI3mzbE+NS835hQ4eu62lapKlGaKpuYG53BPYSVtzgCCPOqXCVuJrsy0mvZXDsrGQgMkAAPJPmdvAjGmpXsm3l5mlk9Cer8SIy1KVNemy34wvUMKoaohyogbCZBjGmcfxDVbaNUOQ1paojdMiz5AgACsk3gjf3J0O+L+BqrVaqYV6xYJawaQsKTTWMDBInMgnVo061KglfiKdGwQQty9QkgxeBDMGJyJIAPy+dWVKFoyX5zv5eoG5O9gnw/wALI6Rw46arHYwtJBz1FIIiZAAjMTIkDVTlJpLVdEW+krIpD1SGVwQSCLlMQJgCARAB2Nfh+cVVDVqVP7CZALEgFgFSIWBG3iSF3iCO4rjy1OrWplFqqAzLSFpck3SSkSY3iMg+ujFTle7/AN8xG0jULxSLUeaU10Dm1u13eCEWrWEgAiwBiMQJAhtZQ1uKrBadThqr0wS0OLQCajMGAbtNt8QMRBAgad8OcbWqv1FoPXU5qhmNoIBwngsc+uAMHy/heZVOr9mtWkGJtpi6982qD7LAXOc52GrU6ODXXrzyFnJrUI/D/LhVVXFV6dJften1ICPYPlW4hPl84kHwDoe1WsVdb1qIGimahtKpLvTKMYN5umYIJjbGnf4yVqKGlLBBWLXvgBiwU7ADGJgnMHVL+IpsQwQJKD5GUDtYi9QBPpMRBwZEaqoy9CTqO1h7c2qVmuqr1CzERBAAJzYkyJJ9INxid9T8qoGnXqJxFA1EqKArFbyFJBFtoYFO4AwD4BjbS5bw1WhSq1lZTSQ9V3BDK5MFvmiSdiBO3ymcleH+NaT1T/EuEfokIbbjDlRl/v3LnIwABvB0JuytBXy4DxTuGm4Hhq9I8NRCDIebhaxywDGeomDuI+UDY6x3Pa5uestMVFn7RGpunTdrAKYcFsNdIM7BtjGjHEc/o8MxekGNSrU6PUhlUszkvUpXGZJZSysDkEg+dCxxFJ4Z3rimFN606gFzYLXGoSMgnyPu/NAAlSv+56ddfU0mrpMKcJFTh1KCjWoTfUUL1agtkkpTnDDACqVYXGJNoUqvL6FBGo0BbejIKch/mtMsvzSuEAUsSfWCdA+SVH6qVOFc9KQGSozd3llRxgRdvC3GPUaOpxYWuUP/ADWRJu7uk5gU+0FROaaggj5lJJk6FV2bivr/AKNGSsUa7VXpM61RUVID02pk+VqMlrSCFaRklgJUeIw/xZx7vVpmqAUUE9hbukgsGOMyFBkYid5nT/FNOml4UktSpiFLMyPSYSGWSD23Su8XkZ31iea8yD1flKpb6zLY7mBnO/nwNtdGzQzvYZO7D3weEq1gycPTpFWUgx2uqssAoYBYEySCuPcTrYcOKdQmpWQLMASHGH7yFpsLSCCc7x8u2styetToL3ntAmDSYuTMjtYgHcxI2z6BtCDRrNhmiAXZXKNTPazWwQCREkEMBGPESrvv5CKV2Yr4g5NVvq1gqmjc7BUqK/TpXynbdNoDjIkC47eJOQ1afaql+q+Li0DHaACTAwJxtjedF+ec3ZVrrZTqM6L9qAFJQsKTl6RWCHEyQZVnWRvOb4ZaSgMzHE4BJuEZAPgeNdUcU4Z+g8u9HM9P4XhXC9Op0bWUrVUqYaVElwNp7TMEEmZG+sd8RclakorRYWtS2nY1MsVIYAoVtaFY2gHfxqX4frXVPtGC0R3h3Zk9CZckYMekAAQMydZWWnUU0quGQhWAUtcI7DUp/fJ22ghjmROuHE6UvyGMuBk/hmi7UmArKrRJphwLkUdwtuJLyTgDYYjfRilxteFNGpUampUFSpDJB75gjtJMz27fnod8Uckp0Up1ZaTWs6U3IK3TeorAsbg7MsAwRjf1znKfiRhUNVWVTBBDntLtAvIH+UMMjP5ao1ji5QNhzubjmaNVpdO9Z7KoenKhXWSwqoMKBmCPPmJ1muC41e6m/DkBWyrKCQxUfNTbfPvsZB20ULvYHWtUNM2BgFWwXDY+SoECSbO0b6sUaSPNUh0IBWoUdyQB8j9JgQgwPX5ZAjGpxajHvrr1Mp8EWf8AEq6oXS2ptItUEqxAYFbsMBDCcnIGbdLieLVqRqLSamzDEL9mSCC4eFIWR7CSJxIJCJyl72DVabgEsFVai1SsFsbLdbBKgyJJ2Eg1yTmgLBbEpgXqrLCk5GKwqNaQQGkAAyBvkam4eF+3Vhr2JOE40cMG6xZVMg027iFYDJqq5TAkEbnadDqvCcPaeiWghO1WYK3cXtnvuAIkdq+fY6J8XSp1oUpaUsPTElQjgQ3ZBKkhYa3aN5gZzmFFqDvYjGksIr90B4N4FQhQSHkYEwB9dGF8+fXl8j35Bo0uGSFqrxgqALd0RWNKSAfsyVOPz0tCk5zgfKMD7w/UxS3O/wCelrKM+P5fwHFEI3Nw1OrUVHVlqrIpkhFaxrm6pJVlG57gQ3bJGTneLL1qhqVA5Sr3PLsgqBYtBpklSB4B8dxmZJbmnxLRXhalGnNQPcrpmnZdJW0gkMN5ECZyd9ZUV67dyfKoYv23YZYJct7A5ER+Wts1ObvJqzElnkg7wvG06TjqDADBVcFlKhTZMCWAxIG+NM5TzThKNWpUgA4Iay9pJnp0VbFMbZ9THidWOS8sWovU4qophWIpWP1AAJV5RlCZt+aQZjBIOo+B5HUqLe7hwAFBKKXNvyLTogwJ9TB7tVSp3lifJPl6X1ESUVm8w+vGioA5qCncXZlYtUCsy2JNsG0STbcIvMkHWe4p3rPFTiBUGVS5elTECSYuIDYImWmdzjUHH134RfsKsk3LYaZVlIjPsRLZwO0R6CL4Y4OrUVgq01tF3/MtNTu7rgJgmVALbx6aWNJRWNPLh1r/AEDvNXLfLLmoGSwUNIp9MlgFkgHYETasyYk7ebnwv8NI6Gs7lDVqQqqyuKP/AKnI+5IBjcwInRBOHrSqwZKgWlkUloJVaYZoYgCBAtwDPgl/huklEUqLAqwucmoED98t3kkhu5qndHqIGNJUqqEZNat8OXXEKV9Ab8O8N0nqsrg0risoLlZ7irNgypugwpAMb4nVFOeURUZYduISspL3EK6sCCxcQAZBaCBMx76p8550H4uueuyU2Kqy9QP8vaIZbgJ7vlnDDfwub0ODenSr0yWYXXmnuuSN56cbR5z48lYm7z48vpxEnbQG/EzHiHwpeox8ParrURikiYJmB4GM40D5Py2o7MEYBl7T3E+dhZJK4+mBq5yqnX601I/hwpJvay5AxO8FhdO0RkeNaPk/w5/E0KrUnp0Kb1e1h3d4cdKmwAErJ+ggQCddymqMbPTrqwE3ogz8LVqNMfw9QyzLYp6cUwIN19TNwtEhcDtyfQjWoilxbV3tArFSzMxMKB1JclSigSR6EE+x1m+XcsqrTeiAWXptULAW1WKkjvcA2oxQQCDCwCe4aHHmrLSXrVXqCtjJZ78qhBGQ2D8pxAI1wuGKbwvXrgvIClZWYZ5nUpNcGBKVXqOUD0xNtRmWHpMoIUiJJETIkATguW8A1LilppUJQ3XHK9lpuukQDAifbxGtZ8R/EvBg0jTBDGkGqLaAGYFh03K+d4O0EA6y9R7nFUpVSgylqbMpC4FxE7NEM0CQY9AddlFSUc1a5niTZuOV9SlYz07UAW66m5puvTBBGLx5JyYPjAGiQejxNWoyBFerQeneCbO5GAIcN3AkxFoGFPhYz/KeeGky0jw6nqkhixYEQ4ZjcEzfI/8ATBjRLiqZ4RqdZaVV6VSo1K8GSk3K2+VNqsIMg4jXJOLUsteBoXAXOalS6pS4hVNWKcveTd2i4nO8wfr4BnWO4ipZVJQjEMs5ggyCPcHzr1X4k5hTrmnUroChirIe2qt4ytwn0+XPsI3805rwdMM/Ra6mHNs4MbrfsA0GD7g69LZpqUbW+CsWtEPTi3q1VDtKghiMDYMRJ8ST+w216PyTlNCpT6Sv8zU3afLy1qrTJKkRDfdMxPtleTcwpJT6ZRu5YaApBYlBfk7RJO2FUZ0uXczWgQpVXtcPTvuEKOoCGcm4AYgf5V2g6lWi28srEX+7QLcz4JKyVEbq034dCwtpmr4ClWQQYNuDO5mTscCKsj5YBOWETHnffG35a9C410r8PUqsWpBoLsal5F8AQxiA15ETi23M6xHMuWNQrmkYkBSGiAysgdCFzuCNVoPKxSm1oX25mrr06ZJyJPcLQLQAp2k7R5k62nw3Tq1Kn2yZEgFyEHTYiDYRLESRImRH5YTheZqjJTFO3EFiN2MZA9TBydHf8fdPuFmVwQpVQhUMpCgkSQzFgfMA/XXJtFK/dXX4FzWSRr+FkKyqKdqFipLLb29RU7iTa2QMggfQxrEfHXLkoOjJQYJUVKkiOmoYlrA4WFJCmVk5JgxrRrx38QorQUrsGavSXP2YZodfDG23YZBxtBKczrUa69KpWvVlN4MgQyswmA3TcE3HwCojGBz0k6U+fF59XKYlxPLF5sFsIDJaBZkNB3xPgRjce3g6vkXMKtNj0alO2rEmp2hj6SQYzvkefXUfxH8N0aCq6utJgoqIWc28QsC5aZMxUHcCASDKiBOA3C1rlDLBpkkEwG8eQwkA+vv6HXZNRqRvEEsrWNq/O6yhabUVCl7xTSrTB6hJlhn5TJ95DT6jI/E/E1Hq02EU6jzdTaQ6BRCsuSLHBJEZBBGrfK+brcy1GqmTHUWtlLoUfdkqSy+8+c6k+Jqy1KS1EVmsIDK9MBjAYEyp+YYN2O0+dzKnTjCehsTTO8u5lUW16tLqIpAcggsqYCgQnaIgBgIxvJGjq0aNZFrhWtqC1vtlqMCQWCVFaAjiYIJP5GIwnC8TVLAlKyUmB7mvFNhuvi2SmZk5kiJ1N/xCC5WkHtu+Q1HZWM5ItbOyx57Zztpp0W846/wG3CxsV+DeHqd68TYDsrVWRh9UFSB+WNc0Bo82rEC1Sw9bS/17szpaTFJcg38n16gdwLPmJaZAAAHmbjJJO3gfy0X5Zz00xZToKxNMiSiE3k5JciYC3DfcjAjNX4s5Z/DOiK5culxiDElgO5ZAi3IBP1Oq3LWREN0yT4JEiMCT7/1/LoWCpTxJXTHnpkF6OajLKHyGRBBgAnuO4J8AeTsNQV6nEs1tNnVUtF6sQSVUACSfaY2kkgCTrp5W7KhFN2a+0IhNxMwwASTgQSDBAIMAZ1PyjlDUKzJxTmkq9/RV0apUZgbFtWVm2CSRCgjyYEsUbXumThD/AKB/LQodVJVUAIN+QCBtrYcoNNGFWvLrHatSZzlLadMNggEwSDCkxB1X5r0AiBqf8KWICkBrYEStg3OMCJnMwSBzmvImayslY1KSXNdUNRKl9wIamA6sdlktsVxuQErVVKKTur3M2pSuyTjPixDe9FjVqdRS5KFcSSEVWYG0AAECJjfEa6yfxVM/xFQIjOqOtJQhrlqjQHcAtYuY9Jg3Y0uJHDNScJSVqwUV2aKi9R7mCxBtY/aMCx9SY2GsZx9TiF6oQhELEbKsmm5LdO2LbZgn2AEbahRpxlkk1bi/46/Ac9Ymk+Jvh7hKFREpJVQFLnUOSbjKqCz4F1pzMi04EknPpSWi1WituyNT2LUwGN7XsAVlio9wSPXRvkdLi69IVX4lzdTtZnVWWwSV7jBBgYafXfyK4nlJdqJlqlSmVYA0iFqLdPzz4t3PqcGY110oySwVJX6vxJSleTzD3MOT8Tw3C1KoKNVolS4YFi1xs6agjugMGmBsMSZFfl/OadahSpXG7p3haSFmevcgNNac5YgsbthYTtjV6lzmuzPRdylwKvVcMWWmFtLXPEYe0G0lpHpjnNuKo0qKHhaIolIQVQygdMLPcHHkMc7iZONRbk0ozWd8mvoBYLZEFXnNUdPh+IoIlYMrXMpiqCalJGdIzHaCTM9OfoD49FqkL2L05PszmCQqyBAaQPOfEDVnkhfiatSpXZWSEADnqSFWVOGUqLYiCMzGZmxxHKkPGUKlKvUVBUvKgFj2G3D5BlCAZnDZB21SnGMZWetuGgJvva2M9yv4XqVqjmqwpqAzXACHMMey4iYYAHyP30e5PwNTgKypUWpxFKo6QaBLyQHNFVRgGViZJIwoGCTrYcXw6Ven0yoUkvTYkHsYDqimILMJYGF8t4AhbPAMnC8WHLzSALCtBImpaCpkSBuJA9JPjU57XKWVsuXXEor/APWhUWhTL1AGp9Uk07RatvUame4EQtwkWwSQ128SL+IOKrfwj0lWq/RHXapLCMMK3UpsdrHZlZcSNo1Z5ryBqCvUp1KoQVOkUZFIvXuuZpEAhVAI2DEbnEXA0K1Ol16C3BxVVqOTVNMEqxkM1wE7+ZJgQCZU/wBy668hlEAVeLFXhyA3dTS5vQEvaYG2bhsd1HknWLVQSyuQ3dIi0Ee5wCRn6ba0XFMe4xAKgMRgvBEE275VSZ8gHVBqgBC2lSDA9CZAMT7eNevRhgTQVFRyRY4Hi0pMGemKgxKlmUETj5JO3j31oF4GhWrtUpKpDC4r1IpIYJUSxsWYI9JHuNB+A5cKiuWLNbkgAY9MjcmNhqMXcPVNJmZDTqywIysgrEj5laQJBgyY0lXN93UjK0m7ah7mwpU6VJ7SlKqxo18oVEGZpoDJIUNOBHtIJyPOKFlW1XLpappkkk2Ado/L8tbLntBuJ4F63DJ2gqay3XWMtqtYhMLMB5Anux66wLVGEXGQAAszgen89bZndXKRReoBSJBkj1wR+e/56ceIqXKAZNwhYn22/vb66p8MVnJKnx6beuiHD8a1JgygyDIZfmG23t9NWnHLQMtNDUcK1SmyhqJdTTtwxBywuZWDQDbg/uMnRLmfLWpDrlvsT0ioUkVKJYkArTOAASp7QCJQMDBnM0PiglXV2tZmBBjD/hvkYzPdjbR/lPPnq0ylQXqwen9oJABjtpem3ggD9j5VSk4PE0TjJrKRHzGvxlLhg0O1FGLM4waYqebCcqWCGR29pJAOdCeP+IGr0XRv+ahFRKoRReQwJRpEwZLGBJKkEmY1snKMhK00Y2NTZFva5HOVan22sOwDLA3WkE5157zLlKonUonqIFl0Pa1M7mAfmXPiSIz66rQ3dRK+qt1/H9jJ52YM4dQ5bqt0zvIgL+U+gHk+dFeKoVqKGordYDaR3BYE96iGB3gjx5zIXqIR5+kzHnxpcE6FwQIg5zbIE+RkztEeddko8RpR4m0+GOMpM68MjVuFqSCQIAiYAdXYkxOLBHqRN2rPNPheiTFSolEooisqkKVi+m1VQ/Y24uxMYLRrG8ZSSoQ17hwCFK5IjYETO5OZE6LnmHEUFV6oqG0i0QrAi6WDkEsPYSRBIAA1ySg4yvDjw8/qBNWE9figSFqUnAJW9KlMo0GCVMiQY9B9Bpaf/wAUcSYK0YWBbgfLAt3Wdo0tPiny69xLLyKfG1pIJ7mwWJJZyYH32EnHj6a7V5VUdgbbVutmVMEAsYE+in9Nc0tOnhUUizdomr+FeaLw1IotxZvIgNG5lz8oP4VWe0STOlR+EqrOnEGuCzhnFykkEMApuBExGcDbA0tLXnbU3QW8hq9fZk6UnJuL0HfEHEVjTptxlXphPKoCajEACobCQsh0ER92cbamb40pCnZSBRXp1KLq4JWVS0FCpJHrkec+o7paXZ4KrRUnzemRSSswI7hQK1EC1QA/Um4MxtUAKxBO4OYxqpzfjTTNKwre9Imrgm9aguC93y2yQGXOMyNLS110UpPPm/x/ZSnCKp3t1dg7jvimoaIpIopie4hiZJxKjAUABVHmB5OdTct+JKvTrEKoYotMMAIRBJa1fJMLvjtjYxrulrtlTjh0OepFRV0g5ylVXhalZqgrG1L6QVgVsYSDUeLpgbDEehxW5tVepwirAVb+1VLBSVhCMlswJPjtO+JWlrijFbz1/gg5NZrkZ7iaJlXC1AiAJVPUm4KThZIPriFEyQBrYfD3ErxSLSFMlXLpTBaCQSFItWAFNgEXAEAzvGlpavtFNbty4rQaVRzs3zSLnHcspUTSrMWKoaYsUxBLlu0mSmVcgpb3ZxjUvxPx1NlKUoCo5IJU2EVafVsUfMMy0mPA+i0tebTvJRk3zHlo0aTgeXLU4MioQ9OoA6PlGAMMFIGe0hQAMQN8RrF8q50aVc9Y3oWCEgQRZXR7gPc0siNttLS1XZoKU5RfWpeysn5Ge+J3HUqRsajgA+snyB7ao8HVVzIBJAiTHp/uP00tLXrU/wBiEWgS+GKFSpVspS1RlZiuALEImbiAfmH66m5uWrvDFEdWLu5SajSpZS1RRJklMeP5rS1yzl/7NeRGassSYf5bwVYpUpU6qMy8O01QrJ1IBtWouDIiycggj01i+a8StWla4C1FFysAIYjYN5BIETkTBxJ0tLR2Z4pSv5DximkwVwsMRdi7b6jOrjLK4/IH6aWlruKBjhlL0oi7p0g5LKNi6oLTO3fsRsPyJb4apIqkPczYRqZgIEDGOm47g4vMMfp765pa8vaVk15nJiaeQ/mNSpw1UVg5qJUY0pYKLu3uWoFAJwSQZ3g7idN5x0q1GvXFiOELVECsINQMpZSMEQQYkfekGY0tLWpRXdfWqRS9mkeZhJPp/fqNXU4FLLyzCMsYBHsYwf56Wlr0JPQvJtaF/jeHAUA3AhfmBENAxcvr9NHOE5oqIFKdtqk93bBAmFKnBn1G/nS0tcc3eKILPUM864JqFd6NDiaopqe0BnAEgE4u9SdLS0tMoeb+3wSlUak0f//Z """

    # CSS to inject contained style
    st.markdown(
        f"""
        <style>
        .stApp {{
            background-image: url("data:image/jpeg;base64,{background_image_base64}");
            background-size: cover;
            background-blur: 10px;
        }}
        </style>
        """,
        unsafe_allow_html=True
    )

    uploaded_file = st.file_uploader("Choose an image...", type=["jpg", "jpeg", "png"])
    if uploaded_file is not None:
        image = Image.open(uploaded_file).convert('RGB')
        st.image(image, caption='Uploaded Image', use_column_width=True)

        if st.button('Classify'):
            with st.spinner('Classifying...'):
                prediction = predict_disease(uploaded_file)
                disease_class = np.argmax(prediction)
                if disease_class == 0:
                    st.write("Prediction: Early Blight")
                elif disease_class == 1:
                    st.write("Prediction: Late Blight")
                else:
                    st.write("Prediction: Healthy Potato Leaf")

if __name__ == '__main__':
    main()
